# 分号避坑指南

JavaScript 语句末尾是否加分号算是前端的一个史诗级争论，在此我并非准备让大家遵循哪一种，因为很多时候这只是个人习惯问题。

比起习惯，我们更关心的是程序的正确运行。对于不喜欢加分号的同学来说，需要注意的是，在某些情况下，是必须要加分号的，可由不得你，否则程序是会报错的。

打开 Chrome 的 F12 将下面的代码贴到 Console 里面

```js
var name = 'tom'
[1].forEach(item => {})
```

你会看到代码报错了

```error
VM980:2 Uncaught TypeError: "tom"[1].forEach is not a function
```

很明显，JavaScript 解析器并未按照我们的意愿来解析代码，而是将两行代码解析成了一行

```js
var name = 'tom'[1].forEach(item => {})
```

这样才导致了上面的问题 `"tom"[1].forEach`。为什么会这样呢？这是由于 JavaScript 有着自动分号插入的机制 `ASI`（Automatic Semicolon Insertion），会在代码的某些地方自动插入分号。

既然是自动的，那就会存在某些判断失误的情况，正如上面的例子。那么在实际开发中应该避免这种坑呢？一个简单的方法就是，凡是每行代码以下面的字符开头的话，那就在前面加上分号：

* `[`
* `(`
* `` ` ``
* `+`
* `*`
* `/`
* `-`
* `,`
* `.`

其实上面除了 `[` 和 `(` ，其它情况出现得并不多，所以要格外注意这两种情况。

```js
var name = 'tom'
;[1].forEach(item => {})
```

再看看其它例子

错误写法：

```js
var a = 1
(function () {
}())
```

正确写法

```js
var a = 1
;(function () {
}())
```